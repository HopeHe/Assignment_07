{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Linfeng_He_06_MSDS597\"\nauthor: \"Linfeng He\"\ndate: \"10/26/2016\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(gdata)\nlibrary(rvest)\nlibrary(gridExtra)\nlibrary(viridis)\nlibrary(stringr)\nlibrary(choroplethr)\n```\n\n####  1. The diamonds dataset is often used to illustrate the ggplot2 package and can be loaded with data(diamonds). Please make a first plot of caret by price, colored by the variable color and using the variable cut to facet_wrap. Please touch up the plot by capitalizing the axes labels and the legend title and by giving an overall title. After that, please make a total of 6 versions of that same plot using different combinations of themes and color palettes. Your choice as to the combinations.\n```{r}\ndata(diamonds)\nplt <- ggplot(diamonds, aes(carat, price)) + geom_point(mapping = aes(carat, price, colour = color)) + facet_wrap(~cut) + xlab(toupper(\"caret\")) +ylab(toupper(\"price\")) + ggtitle(\"Caret, color and price of diamonds\")\nplt$labels$colour <- \"COLOR\"\ngrid.arrange(\n    plt + theme_economist() + scale_color_economist(),\n    plt + scale_color_brewer(type = \"div\", palette = \"Spectral\") + theme_light(),\n    plt + scale_color_brewer(type = \"seq\", palette = \"Blues\") + theme_minimal(),\n    plt + scale_color_brewer(type = \"div\", palette = \"BrBG\") + theme_map(),\n    plt + scale_color_brewer(type = \"seq\", palette = \"Greys\") +theme_bw(),\n    plt + scale_color_brewer(type = \"seq\", palette = \"YlOrRd\") +theme_few(),\n    ncol = 2, nrow = 3\n)\n```\n#### 2. The website https://www.theguardian.com/news/datablog/2012/nov/07/us-2012-election-county-results-download has county-level election results for the 2012 US Presidential election.  \n\nFor each of these, please produce a map with continuous colors and a map with binned colors (I suggest 9), and for each produce both a national and a NJ map (so you will have 3 x 2 x 2 maps). Feel free to use the default color scheme. Finally, take the binned NJ map in (c) and draw it with 2 additional color palettes.\n```{r}\nsheet <- read.xls(\"US_elect_county.xls\", sheet = 1) %>%\n    filter(FIPS!= \"0\")\n    \ncolnames(sheet)[5] <- \"Obama.vote.percent\"\ncolnames(sheet)[7] <- \"Romney.vote.percent\"\ncolnames(sheet)[3] <- \"region\"\n\nsheet <- filter(sheet , duplicated(sheet$region) == FALSE)\n```\na). The popular vote totals to Obama\n```{r}\nsheet$Obama.vote <-\n    sheet$Obama.vote %>%\n    str_replace_all(.,\",\",\"\") %>%\n    as.numeric(.)\n\ngrid.arrange(\n    sheet %>% \n        dplyr::rename(value = Obama.vote) %>% \n        county_choropleth(title = \"Countrywise Votes to Obama (Continuous color)\", num_colors = 1),\n    sheet %>% \n        dplyr::rename(value = Obama.vote) %>% \n        county_choropleth(title = \"Countrywise Votes to Obama (Binned color)\", num_colors = 9),\n    sheet %>% \n        dplyr::rename(value = Obama.vote) %>% \n        county_choropleth(title = \"Jersey votes to Obama(Continuous color)\", num_colors = 1, state_zoom = \"new jersey\"),\n    sheet %>% \n        dplyr::rename(value = Obama.vote) %>% \n        county_choropleth(title = \"Jersey votes to Obama(Binned color)\", num_colors = 9, state_zoom = \"new jersey\"),\n    ncol = 2, nrow = 2\n)\n\n```\nb). The popular vote totals for Romney \n```{r}\nsheet$Romney.vote <-\n    sheet$Romney.vote %>%\n    str_replace_all(.,\",\",\"\") %>%\n    as.numeric(.)\n\ngrid.arrange(\n    sheet %>% \n        dplyr::rename(value = Romney.vote) %>% \n        county_choropleth(title = \"Countrywise Votes to Romney (Continuous color)\", num_colors = 1),\n    sheet %>% \n        dplyr::rename(value = Romney.vote) %>% \n        county_choropleth(title = \"Countrywise Votes to Romney (Binned color)\", num_colors = 9),\n    sheet %>% \n        dplyr::rename(value = Romney.vote) %>% \n        county_choropleth(title = \"Jersey votes to Romney(Continuous color)\", num_colors = 1, state_zoom = \"new jersey\"),\n    sheet %>% \n        dplyr::rename(value = Romney.vote) %>% \n        county_choropleth(title = \"Jersey votes to Romney(Binned color)\", num_colors = 9, state_zoom = \"new jersey\"),\n    ncol = 2, nrow = 2\n)\n```\nc). The percentage of the 2-candidate vote for Obama\n```{r}\ngrid.arrange(\n    sheet %>% \n        dplyr::rename(value = Obama.vote.percent) %>% \n        county_choropleth(title = \"Countrywise percentage of Votes to Obama (Continuous color)\", num_colors = 1),\n    sheet %>% \n        dplyr::rename(value = Obama.vote.percent) %>% \n        county_choropleth(title = \"Countrywise percentage of Votes to Obama (Binned color)\", num_colors = 9),\n    sheet %>% \n        dplyr::rename(value = Obama.vote.percent) %>% \n        county_choropleth(title = \"Jersey percentage of votes to Obama(Continuous color)\", num_colors = 1, state_zoom = \"new jersey\"),\n    sheet %>% \n        dplyr::rename(value = Obama.vote.percent) %>% \n        county_choropleth(title = \"Jersey percentage of votes to Obama(Binned color)\", num_colors = 9, state_zoom = \"new jersey\"),\n    ncol = 2, nrow = 2\n)\n\nsheet.custom <-\n  sheet %>% \n  dplyr::rename(value = Obama.vote.percent) %>% \n  county_choropleth(title = \"Jersey percentage of votes to Obama(Binned color)\", num_colors = 9, state_zoom = \"new jersey\")\n\ngrid.arrange(\n  sheet.custom + scale_fill_brewer(type = \"seq\", palette = \"Blues\") + theme_economist(),\n  sheet.custom + scale_fill_brewer(type = \"seq\", palette = \"YlOrRd\") + theme_few(),\n  ncol = 2, nrow = 1\n)\n```\n#### 3. The weather history on October 17 for the closest (small) airport to Piscataway can be found at   https://www.wunderground.com/history/airport/KSMQ/2016/10/17/DailyHistory.html?req_city=Piscataway&req_state=NJ&req_statename=New+Jersey&reqdb.zip=08854&reqdb.magic=1&reqdb.wmo=99999\n\nPlease plot the time of day against temperature and dew point for the day (I suggest using a line and points for each, and separate colors for the temp/dew point).\n\n```{r}\nurl <- \"https://www.wunderground.com/history/airport/KSMQ/2016/10/17/DailyHistory.html?req_city=Piscataway&req_state=NJ&req_statename=New+Jersey&reqdb.zip=08854&reqdb.magic=1&reqdb.wmo=99999\"\nweather_table <- \n    url %>%\n    read_html() %>%\n    html_nodes(\"#obsTable\") %>%\n    html_table(fill = TRUE)\nweather <- weather_table[[1]]\n\nweather$`Time (EDT)` <-\n  weather$`Time (EDT)` %>%\n  str_replace_all(., \"[A-Z]\",\"\") %>% \n  str_trim(.) %>% \n  as.POSIXct(., format = \"%H:%M\")\n\nweather$`Time (EDT)`[23:33] <- weather$`Time (EDT)`[23:33] + 12*60*60\nweather$`Time (EDT)`[1] <- weather$`Time (EDT)`[1] - 12*60*60 \n\nweather$Temp. <- \n  weather$Temp. %>% \n  str_extract_all(., \"[0-9]*\\\\.[0-9]\",\"\") %>%\n  as.numeric()\n\nweather$`Dew Point` <- \n  weather$`Dew Point` %>% \n  str_extract_all(., \"[0-9]*\\\\.[0-9]\",\"\") %>%\n  as.numeric()\n\nggplot(weather, aes(`Time (EDT)`)) + geom_line(aes(y = Temp.), colour = \"red\") + geom_point(aes(y = `Dew Point`), colour = \"blue\")\n```\n",
    "created" : 1478502814954.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2669715373",
    "id" : "5FA386BE",
    "lastKnownWriteTime" : 1477940904,
    "last_content_update" : 1477940904,
    "path" : "~/Documents/MSDS 597 Data Wrangling n Husbandary /homework/Linfeng_He_hw06..Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}